<app-page-loaders [hidden]="isClientReady"></app-page-loaders>
<div class="main-content pt-md-0 px-md-0 px-lg-4">
  <div class="container-fluid">
    <div layout-align="end end">
      <h2 class="bold" *ngIf="isMobile">
        <u>{{ titleService.getTitle().split(":")[0] }}</u>
      </h2>
    </div>

    <app-page-question
      [questionHeader]="
        ' When did governments start taking action, and what were the effects? Join the discussion.'
      "
    >
      <div class="readMore">
        <p class="question">
          Witnessing the effects within our own countries, we are examining the
          timing, duration, and severity of the measures taken by our
          governments in response to the COVID-19 outbreak.
        </p>
        <p class="question">
          To answer this question seriously, we need to understand first:
        </p>
        <ul>
          <li>When did governments start taking action?</li>
          <li>What were the sequence of measures taken?</li>
          <li>
            How effective were each countryâ€™s measures in comparison to others?
          </li>
        </ul>
        <p class="question">
          CovidMeasures aims to provide facts and perspectives to enrich your
          reflections. We encourage you to contribute to the debate.
        </p>
      </div>
    </app-page-question>
    <!-- ------------------------------ PAGE Navigator ----------------------------------------->
    <app-page-navigator
      [pageSections]="[
        { name: 'Global Data', sectionID: 'globalData' },
        { name: 'Impacts', sectionID: 'impacts' },
        { name: 'Comments', sectionID: 'comments' }
      ]"
      [navTopDistance]="326"
      *ngIf="isClientReady"
    ></app-page-navigator>
    <!-- ------------------------------ GLOBAL DATA SECTION ----------------------------------------->
    <div class="global-data" id="globalData">
      <app-page-separator [title]="'Global Data'"></app-page-separator>
      <div class="container pt-3" style="max-width: 1400px">
        <h3>Government measures in response to COVID-19</h3>
        <div class="row pl-5">
          <div class="col-md-5">
            <div class="card">
              <div class="card-body card-country">
                <mat-select
                  [(value)]="countryView"
                  (selectionChange)="countryChangeView($event.value)"
                >
                  <mat-option
                    *ngFor="let country of countryList"
                    [value]="country.value"
                  >
                    {{ country.viewValue }}
                  </mat-option>
                </mat-select>
              </div>
            </div>
          </div>
          <div class="col-md-8"></div>
        </div>

        <div class="form-row">
          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/school">Educational Facilities Closure</h4>
              </div>
              <div class="text-center">
                <i class="material-icons size-padding">school</i>
                <p class="align-weight">
                  Started On {{ schoolClosure.date | date }}
                </p>
                <p class="align-weight">Currently {{ schoolClosure.status }}</p>
                <div class="d-flex justify-content-end">
                  <a
                    class="decor-off"
                    data-toggle="collapse"
                    href="#collapseSchoolClosure"
                    role="button"
                    aria-expanded="false"
                    aria-controls="collapseSchoolClosure"
                  >
                    <h4
                      class="d-flex justify-content-center text-primary px-3 weight"
                    >
                      More
                      <i class="material-icons">arrow_drop_down</i>
                    </h4>
                  </a>
                </div>
                <div class="collapse" id="collapseSchoolClosure">
                  <div class="bg-light py-3 m-0">
                    <p>
                      <span class="weight">Current coverage:</span>
                      {{ schoolClosure.current_coverage }}
                    </p>
                    <p>
                      <span class="weight">Started reopening on:</span>
                      {{ schoolClosure.start_reopening }}
                    </p>
                    <p>
                      <span class="weight">Ended measures on:</span>
                      {{ schoolClosure.end }}
                    </p>
                    <p>{{ schoolClosure.comment }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/borders">Movement Restrictions</h4>
              </div>
              <div>
                <i class="material-icons size-padding">lock</i>
                <p class="align-weight">
                  Started on {{ lockdown.date | date }}
                </p>
                <p class="align-weight">Currently {{ lockdown.status }}</p>
                <div class="d-flex justify-content-end">
                  <a
                    class="decor-off"
                    data-toggle="collapse"
                    href="#collapseMovementRestriction"
                    role="button"
                    aria-expanded="false"
                    aria-controls="collapseMovementRestriction"
                  >
                    <h4
                      class="d-flex justify-content-center text-primary px-3 weight"
                    >
                      More
                      <i class="material-icons">arrow_drop_down</i>
                    </h4>
                  </a>
                </div>
                <div class="collapse" id="collapseMovementRestriction">
                  <div class="bg-light py-3 m-0">
                    <p>
                      <span class="weight">Number of lockdowns:</span>
                      {{ lockdown.lockdown_counter }}
                    </p>
                    <p>
                      <span class="weight">Current coverage:</span>
                      {{ lockdown.current_coverage }}
                    </p>
                    <p>
                      <span class="weight">Type of restrictions:</span>
                      {{ lockdown.restriction_type }}
                    </p>
                    <p>
                      <span class="weight">Started softening measures on:</span>
                      {{ lockdown.start_reopening | date }}
                    </p>
                    <p>
                      <span class="weight">Ended measures on:</span>
                      {{ lockdown.end | date }}
                    </p>
                    <p>{{ lockdown.comment }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/lockdown">Businesses Closure</h4>
              </div>
              <i class="material-icons size-padding">store</i>
              <p class="align-weight">
                Started on {{ businessClosure.date | date }}
              </p>
              <p class="align-weight">Currently {{ businessClosure.status }}</p>
              <div class="d-flex justify-content-end">
                <a
                  class="decor-off"
                  data-toggle="collapse"
                  href="#collapseBusiness"
                  role="button"
                  aria-expanded="false"
                  aria-controls="collapseBusiness"
                >
                  <h4
                    class="d-flex justify-content-center text-primary px-3 weight"
                  >
                    More
                    <i class="material-icons">arrow_drop_down</i>
                  </h4>
                </a>
              </div>
              <div class="collapse" id="collapseBusiness">
                <div class="bg-light py-3 m-0">
                  <p>
                    <span class="weight">Start softening date:</span>
                    {{ businessClosure.start_reopening_business }}
                  </p>
                  <p>
                    <span class="weight">Ended measures on:</span>
                    {{ businessClosure.end_business }}
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/borders" >International Travel</h4>
              </div>
              <i class="material-icons size-padding">flight_land</i>
              <p class="align-weight">Started on {{ travel.start | date }}</p>
              <p class="align-weight">Currently {{ travel.status }}</p>
            </div>
          </div>

          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/masks">Masks</h4>
              </div>
              <i class="material-icons size-padding">healing</i>
              <p class="align-weight">Started on No Data</p>
              <p class="align-weight">Currently No data</p>
            </div>
          </div>

          <div class="col-md-4 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/testing">Testing</h4>
              </div>
              <i class="material-icons size-padding">local_hospital</i>
              <p class="align-weight">Daily test performed: {{ testingDaily | number }}</p>
              <p class="align-weight">Current Positivity Rate: {{ testingPositiveRatio | number }}%</p>
            </div>
          </div>
        </div>

        <div>
          <p class="text-primary margin-padding">
            <b
              ><a href="https://forms.gle/e6mXPravJkLtRWPq5" target="_blank"
                >Is this information not up-to-date?</a
              ></b
            >
          </p>
        </div>
        <!------------------------------------------- Evolution Graph  --------------------------->
        <h3 class="mb5">Evolution of COVID-19 in the country</h3>
        <app-evolution-country
          [countryView]="countryView"
          [countryList]="countryList"
          [evolution]="evolution"
          (switchCountry)="countryChangeView($event)"
          *ngIf="isClientReady"
        ></app-evolution-country>
        <br />
      </div>
    </div>

    <!-- ------------------------------ IMPACTS SECTION ----------------------------------------->
    <div class="impacts-data" id="impacts">
      <app-page-separator [title]="'Impacts'"></app-page-separator>
      <div class="container pt-5" style="max-width: 1400px">
        <h3>Government Measures' Impacts On Citizens</h3>

        <div class="card center">
          <div class="card-body">
            <ng-container *ngIf="isMobile">
              <mat-select
                [(value)]="currentOption"
                (selectionChange)="changeViewOption($event.value)"
              >
                <mat-option
                  class="select-color"
                  *ngFor="let option of options"
                  [value]="option"
                >
                  {{ option }}
                </mat-option>
              </mat-select>
            </ng-container>

            <div *ngIf="!isMobile" class="center">
              <ng-container *ngFor="let option of options">
                <button
                  mat-raised-button
                  *ngIf="currentOption === option"
                  class="float"
                  type="button"
                  color="primary"
                >
                  <span>{{ option }}</span>
                </button>

                <button
                  mat-button
                  *ngIf="currentOption !== option"
                  class="float"
                  type="button"
                  color="primary"
                  (click)="changeViewOption(option)"
                >
                  <span>{{ option }}</span>
                </button>
              </ng-container>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="col-md-6 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/school">Children Homeschooling</h4>
              </div>

              <div class="card-body">
                <table class="table">
                  <thead class="text-primary">
                    <th class="header">Children Impacted</th>
                    <th class="header">Cumulated Years At Home</th>
                  </thead>
                  <tbody>
                    <td class="cell">
                      {{ schoolClosure.impacted_children | number }}
                    </td>
                    <td class="cell">
                      {{ schoolClosure.years | number: ".0-0" }}
                    </td>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="col-md-6 text-center">
            <div class="card card-border">
              <div class="card-header card-header-success">
                <h4 class="card-title link" routerLink="/lockdown">People Staying Inside</h4>
              </div>

              <div class="card-body">
                <table class="table">
                  <thead class="text-primary">
                    <th class="header">People Impacted</th>
                    <th class="header">Cumulated Years At Home</th>
                  </thead>
                  <tbody>
                    <td class="cell">{{ countryImpactedPeople | number }}</td>
                    <td class="cell">
                      {{ countryCumulatedYears | number: ".0-0" }}
                    </td>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div class="card-grid d-flex justify-content-center text-center">
          <div class="card card-border col-md-12">
            <div class="card-header card-header-success">
              <h4 class="card-title link" routerLink="/impacts" [queryParams]="{section: 'economicImpacts'}">Economic Slowdown</h4>
            </div>

            <div class="card-body">
              <table class="table">
                <thead class="text-primary">
                  <th class="header">Number of Days</th>
                  <th class="header">GDP Change</th>
                  <th class="header">Imports Change</th>
                  <th class="header">Exports Change</th>
                  <th class="header">Unemployment Change</th>
                </thead>
                <tbody>
                  <td class="cell">
                    {{ businessClosure.days | number }}
                  </td>
                  <td class="cell"
                    [ngClass]="{positive: economic_data['GDP'].avg > 0, negative: economic_data['GDP'].avg < 0}"
                  >
                    {{ economic_data['GDP'].avg | number:'.0-1' }}%
                  </td>
                  <td class="cell"
                    [ngClass]="{positive: economic_data['Imports'].avg > 0, negative: economic_data['Imports'].avg < 0}"
                  >
                    {{ economic_data['Imports'].avg | number:'.0-1' }}%
                  </td>
                  <td class="cell"
                    [ngClass]="{positive: economic_data['Exports'].avg > 0, negative: economic_data['Exports'].avg < 0}"
                  >
                    {{ economic_data['Exports'].avg | number:'.0-1' }}%
                  </td>
                  <td class="cell"
                    [ngClass]="{positive: economic_data['Unemployment Rate'].avg < 0, negative: economic_data['Unemployment Rate'].avg > 0}"
                  >
                    {{ economic_data['Unemployment Rate'].avg | number:'.0-1' }}%
                  </td>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="card card-border">
            <div class="card-header card-header-success">
              <h3 class="card-title">
                List of Impacts in {{ currentCountryName }}
              </h3>
            </div>

            <div class="row mt3" [ngClass]="{ 'mobile-table-text': isMobile }">
              <div class="col-md-1"></div>
              <div class="col-md-7">
                <h4>
                  Tell us about other impacts of government measures in
                  {{ currentCountryName }}
                </h4>
                <p class="left-align">
                  We want to hear both positive and negative impacts of those
                  measures.<br />
                  <!-- Vote for the most impactful in your life and the life of others around you (coming soon).<br> -->
                  <b>
                    An impact can be mental, physical, direct, or indirect - an
                    impact is any change in your life.
                  </b>
                </p>
              </div>
              <div class="col-md-3">
                <button mat-raised-button
                  class="nav-link float-right decor-off"
                  type="button"
                  color="primary"
                  (click)="openPopUp()"
                >
                  <span class="span.size">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                    Add an Impact
                  </span>
                </button>
              </div>
              <div class="col-md-1"></div>
            </div>
            <hr />
            <div class="card m-0 p-0 px-sm-2 pt-2">
              <div class="card-body m-0 p-0">
                <div class="card m-0 p-0 px-sm-2">
                  <div class="card-body m-0 p-0">
                    <div class="content table-responsive table-full-width">
                      <table class="table">
                        <thead>
                          <th
                            class="text-primary"
                            *ngFor="let row of impactHeaders"
                          >
                            {{ row }}
                          </th>
                        </thead>
                        <tbody>
                          <tr *ngFor="let row of impactTable">
                            <td>{{ row.measure }}</td>
                            <td>{{ row.impact }}</td>
                            <td>{{ row.description }}</td>
                            <td *ngIf="row.source.startsWith('http')">
                              <a href="{{ row.source }}" target="_blank">{{
                                row.source.split("/")[2]
                              }}</a>
                            </td>
                            <td *ngIf="!row.source.startsWith('http')">
                              {{ row.source }}
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>

                <div class="card-footer">
                  <div class="stats">Source: CovidMeasures Community</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ----------------------------------------------- COMMENTS SECTION -------------------------------------->
    <div id="comments">
      <app-page-separator [title]="'Comments'"></app-page-separator>
      <div class="container pt-5" style="max-width: 1400px">
        <div class="row justify-content-center p-0">
          <div class="col-12 p-sm-0 p-md-1" style="width: 100%">
            <div *ngIf="lockdownData">
              <app-disqus-comments
                [uniqueString]="'$wrID'"
                [uniqueAll]="true"
                [baseUrl]="'https://covidmeasures.info'"
                [page]="'country'"
                [countriesData]="lockdownData.countries"
                [countryAlpha3]="countryView"
              ></app-disqus-comments>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
